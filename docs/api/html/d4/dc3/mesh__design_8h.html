<!-- HTML header for doxygen 1.8.8-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
    <head>
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <!-- For Mobile Devices -->
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
        <meta name="generator" content="Doxygen 1.8.11"/>
        <script type="text/javascript" src="https://code.jquery.com/jquery-2.1.1.min.js"></script>
        <title>SJSU One API: /var/www/html/SJSU-DEV-Linux/firmware/default/lib/L4_IO/wireless/src/mesh_design.h File Reference</title>
        <!--<link href="../../tabs.css" rel="stylesheet" type="text/css"/>-->
        <script type="text/javascript" src="../../dynsections.js"></script>
        <link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/searchdata.js"></script>
<script type="text/javascript" src="../../search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
        <link href="../../doxygen.css" rel="stylesheet" type="text/css" />
        <link href="../../customdoxygen.css" rel="stylesheet" type="text/css"/>
        <link href='https://fonts.googleapis.com/css?family=Roboto+Slab' rel='stylesheet' type='text/css'>
        <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.1/css/bootstrap.min.css">
        <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.1/js/bootstrap.min.js"></script>
        <script type="text/javascript" src="../../doxy-boot.js"></script>
    </head>
    <body>
        <nav class="navbar navbar-default" role="navigation">
            <div class="container">
                <div class="navbar-header">
                    <a class="navbar-brand">SJSU One API </a>
                </div>
            </div>
        </nav>
        <div id="top"><!-- do not remove this div, it is closed by doxygen! -->
            <div class="content" id="content">
                <div class="container">
                    <div class="row">
                        <div class="col-sm-12 panel " style="padding-bottom: 15px;">
                            <div style="margin-bottom: 15px;">
<!-- end header part --><!-- Generated by Doxygen 1.8.11 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "../../search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="../../index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="../../modules.html"><span>Modules</span></a></li>
      <li><a href="../../namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="../../annotated.html"><span>Data&#160;Structures</span></a></li>
      <li class="current"><a href="../../files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="../../search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="../../search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="../../files.html"><span>File&#160;List</span></a></li>
      <li><a href="../../globals.html"><span>Globals</span></a></li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="../../dir_d9edf6c004b4a7ff14fe9ae7a92214ee.html">firmware</a></li><li class="navelem"><a class="el" href="../../dir_1cd4931aa993753d363e928640341ec9.html">default</a></li><li class="navelem"><a class="el" href="../../dir_98f6e3228cef689a79f0d5c275585dc1.html">lib</a></li><li class="navelem"><a class="el" href="../../dir_b0dc845ac9411c4da6fe9228642d207e.html">L4_IO</a></li><li class="navelem"><a class="el" href="../../dir_cd408842faec11fe5b389c4eac32f511.html">wireless</a></li><li class="navelem"><a class="el" href="../../dir_96c6e48c721d512b3f7a318b36dc5927.html">src</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">mesh_design.h File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>This is a documentation only file for the mesh algorithm.  
<a href="#details">More...</a></p>

<p><a href="../../d4/dc3/mesh__design_8h_source.html">Go to the source code of this file.</a></p>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>This is a documentation only file for the mesh algorithm. </p>
<p>/* SocialLedge.com - Copyright (C) 2013</p>
<p>This file is part of free software framework for embedded processors. You can use it and/or distribute it as long as this copyright header remains unmodified. The code is free for personal use and requires permission to use in a commercial product.</p>
<p>THIS SOFTWARE IS PROVIDED "AS IS". NO WARRANTIES, WHETHER EXPRESS, IMPLIED OR STATUTORY, INCLUDING, BUT NOT LIMITED TO, IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE APPLY TO THIS SOFTWARE. I SHALL NOT, IN ANY CIRCUMSTANCES, BE LIABLE FOR SPECIAL, INCIDENTAL, OR CONSEQUENTIAL DAMAGES, FOR ANY REASON WHATSOEVER.</p>
<p>You can reach the author of this software at : p r e e t . w i k i @ g m a i l . c o m</p>
<dl class="section user"><dt>Features</dt><dd>This mesh algorithm features :<ul>
<li>Addressed nodes with auto-retries, and auto-acknowledge.</li>
<li>Minimal RAM footprint with no HEAP usage.</li>
<li>Each node contains routing table and can act like a repeater node.</li>
<li>Each packet contains its retry counts, and maximum hops it can take.</li>
</ul>
</dd></dl>
<p>Detailed features :</p><ul>
<li>Each packet sent can use existing route, and if route has changed, a new route is automatically discovered using a special retry packet.</li>
<li>Each node's ACK contains some piggy-back data about the node itself.</li>
<li>Duplicate packets are absorbed but an ACK is still replied if its a duplicate, but a retry packet.</li>
<li>An ACK packet or a response to an ACK all use retries; even the repeating nodes participate to make sure the packet is delivered.</li>
</ul>
<dl class="section user"><dt>Example use case</dt><dd>Suppose there are 4 nodes in your network, and the nodes only know about their neighbors (ie: N1 only knows N2, but doesn't know where is N3 and N4): <pre class="fragment"> N1      N2      N3      N4
</pre></dd></dl>
<p>Each node maintains a routing table of 3 fields :</p><ul>
<li>Destination Node</li>
<li>Next Destination</li>
<li>Hop count to destination node</li>
</ul>
<p>Here is how the mesh algorithm works step-by-step when N1 sends data to N4 : D=Destination, S=Source, MD=Mesh Destination, MS=Mesh Source Table: X|Y|Z where X=TO, Y=Next destination, Z=Hops </p><hr/>
 <h1>Here is how a packet is sent to unknown node N4 </h1>
<p>N1 N2 N3 N4 Route Table : &lt;Empty&gt; &lt;Empty&gt; &lt;Empty&gt; &lt;Empty&gt; Packet : D(4), S(1) MD(0),MS(1)</p>
<p>N1 N2 N3 N4 Route Table : &lt;Empty&gt; D1|D1|0 &lt;Empty&gt; &lt;Empty&gt; Packet : D(4), S(1) MD(0),MS(2)</p>
<p>N1 N2 N3 N4 Route Table : &lt;Empty&gt; D1|D1|0 D2|D2|0 &lt;Empty&gt; D1|D2|1 Packet : D(4), S(1) MD(0),MS(3)</p>
<p>N1 N2 N3 N4 Route Table : &lt;Empty&gt; D1|D1|0 D2|D2|0 D3|D3|0 D1|D2|1 D1|D3|2 Packet : D(4), S(1) MD(0),MS(3) </p><hr/>
 <h1>Now let's take a look at how the packet travels back : </h1>
<p>TODO</p>
<hr/>
<p> Future work and improvement possibilities :</p><ul>
<li>RSS (Received Signal Strength) should be factored into the routing table for those radios that support it.</li>
<li>If routing table is full, the route least used should be removed, therefore we need to add a "score" variable to the routing table structure.</li>
<li>Implement "packet_status" for each packet sent? ie: "BUSY", "RETRYING", "DELIVERED", "TIMEOUT", or "ERROR"</li>
<li>Implement special packet to query N-th routing entry of a node.</li>
<li>An ACK packet should contain what sequence number the ACK is for <h1>such that more than one packet with an ACK can be out at a time. </h1>
</li>
</ul>
<p>How some scenarios are handled :</p>
<p>Scenario 1 : N1 &ndash;&gt; N2 &ndash;&gt; N3 N1 knows N3, but what if N3 disappears, and is now directly reachable without any intermediate node ? N1 will send packet with MD being N2, but instead, N3 will directly respond back, and now N1 will update its routing table.</p>
<p>Scenario 2 : N1 &ndash;&gt; N2 &ndash;&gt; N3 N1 knows N3, but N2 has disappeared and a new node N2b has replaced N2. N1 will retry its packets, and eventually realize after retry count-down that N3 no longer has a good route entry, so that route entry will be removed, and when N1 resends the packet again, new route discovery will be performed through N2b.</p>
<p>Scenario 3 : N1 &ndash;&gt; N2 &ndash;&gt; N3 N1 knows N3, but say that N2 can no longer reach N3. After some retries, N2 will give up on N3 destined packet because N3 would not have sent an ACK back. Option 1 (not implemented) : N2 can send a special packet to N1 telling it to remove its route of N3 through N2. Option 2 (simpler) : N1 will send retries through N2, and after N3 is not reachable, its route will be removed, and when a packet is sent again, new route discovery will be performed. </p><hr/>
</div></div><!-- contents -->
<!-- HTML footer for doxygen 1.8.8-->
<!-- start footer part -->
</div>
</div>
</div>
</div>
</div>
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="../../doxygen.png" alt="doxygen"/>
</a> 1.8.11
</small></address>
</body>
</html>
